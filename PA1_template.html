<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title>Loading and preprocessing the data</title>

<script type="text/javascript">
window.onload = function() {
  var imgs = document.getElementsByTagName('img'), i, img;
  for (i = 0; i < imgs.length; i++) {
    img = imgs[i];
    // center an image if it is the only element of its parent
    if (img.parentElement.childElementCount === 1)
      img.parentElement.style.textAlign = 'center';
  }
};
</script>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: #990073
   }

   pre .number {
     color: #099;
   }

   pre .comment {
     color: #998;
     font-style: italic
   }

   pre .keyword {
     color: #900;
     font-weight: bold
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: #d14;
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>



<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 13px;
}

body {
  max-width: 800px;
  margin: auto;
  padding: 1em;
  line-height: 20px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 {
   font-size:2.2em;
}

h2 {
   font-size:1.8em;
}

h3 {
   font-size:1.4em;
}

h4 {
   font-size:1.0em;
}

h5 {
   font-size:0.9em;
}

h6 {
   font-size:0.8em;
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre, img {
  max-width: 100%;
}
pre {
  overflow-x: auto;
}
pre code {
   display: block; padding: 0.5em;
}

code {
  font-size: 92%;
  border: 1px solid #ccc;
}

code[class] {
  background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * {
      background: transparent !important;
      color: black !important;
      filter:none !important;
      -ms-filter: none !important;
   }

   body {
      font-size:12pt;
      max-width:100%;
   }

   a, a:visited {
      text-decoration: underline;
   }

   hr {
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote {
      padding-right: 1em;
      page-break-inside: avoid;
   }

   tr, img {
      page-break-inside: avoid;
   }

   img {
      max-width: 100% !important;
   }

   @page :left {
      margin: 15mm 20mm 15mm 10mm;
   }

   @page :right {
      margin: 15mm 10mm 15mm 20mm;
   }

   p, h2, h3 {
      orphans: 3; widows: 3;
   }

   h2, h3 {
      page-break-after: avoid;
   }
}
</style>



</head>

<body>
<h2>Loading and preprocessing the data</h2>

<p>Set global options.</p>

<pre><code class="r">knitr::opts_chunk$set(warning=FALSE, message=FALSE, fig.height=6, fig.width=6)
</code></pre>

<p>Download the file using the specified link and unzip in the working directory.  </p>

<pre><code class="r">setwd(&quot;C:/Users/ssbhat3/Desktop/Coursera ReproducibleResearch/RepData_PeerAssessment1/RepData_PeerAssessment1&quot;)
getwd()
Source &lt;- &quot;https://d396qusza40orc.cloudfront.net/repdata%2Fdata%2Factivity.zip&quot;
Destination &lt;- &quot;activity.zip&quot;
download.file(Source, Destination, mode=&quot;wb&quot;) 
unzip(Destination)
</code></pre>

<p>This creates a file <code>activity.csv</code>. Read into a <code>data.table</code>.</p>

<pre><code class="r">library(data.table)
DTact &lt;- as.data.table(read.csv(&quot;activity.csv&quot;))
DTact
</code></pre>

<pre><code>##        steps       date interval
##     1:    NA 2012-10-01        0
##     2:    NA 2012-10-01        5
##     3:    NA 2012-10-01       10
##     4:    NA 2012-10-01       15
##     5:    NA 2012-10-01       20
##    ---                          
## 17564:    NA 2012-11-30     2335
## 17565:    NA 2012-11-30     2340
## 17566:    NA 2012-11-30     2345
## 17567:    NA 2012-11-30     2350
## 17568:    NA 2012-11-30     2355
</code></pre>

<p>Set the date in a format that <code>R</code> recognizes.</p>

<pre><code class="r">DTact[, lapply(.SD, class)]
DTact[, date := as.Date(date)]
str(DTact)
</code></pre>

<p>We are now all set to process data.</p>

<h2>What is mean total number of steps taken per day?</h2>

<p>Calculate the number of steps per day.</p>

<pre><code class="r">DTact[, Total := sum(steps), by=date]
</code></pre>

<p>The histogram reveals the central tendency and spread.</p>

<pre><code class="r">library(ggplot2)
DTact[, {
  m &lt;- ggplot(.SD, aes(x=Total))
  m &lt;- m + geom_histogram(aes(y=..density..), binwidth=3000, 
                          color=&quot;black&quot;, fill=&quot;wheat&quot;, alpha=0.2) 
  m &lt;- m + geom_density(fill=&quot;gray&quot;, alpha=0.2)
  m &lt;- m + geom_vline(aes(xintercept=mean(Total, na.rm=TRUE)),
                      color=&quot;red&quot;, linetype=&quot;dashed&quot;, size=1)
  m &lt;- m + geom_vline(aes(xintercept=median(Total, na.rm=TRUE)),
                      color=&quot;blue&quot;, linetype=&quot;dashed&quot;, size=1)
  m &lt;- m + xlab(&quot;Daily Activity (Steps)&quot;) + ylab(&quot;Density&quot;) + 
          ggtitle(&quot;Variation in Daily Activity Levels&quot;)

}]
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-6"/> </p>

<p>The mean and median are shown on the histogram.</p>

<pre><code class="r">DTact[, summary(Total, na.rm=TRUE)]
</code></pre>

<p>The total number of steps per day have <code>mean=10770</code> and <code>median=10760</code>. The overlay shows data are very noisy.</p>

<h2>What is the average daily activity pattern?</h2>

<p>Let&#39;s look at any pattern in activity by time of day. The time of day is specified by interval number. We can average the number of steps in any interval across all days.</p>

<pre><code class="r">DTint &lt;- DTact[, .(interMean = mean(steps, na.rm=TRUE)), by=interval]
DTint[, {
  t &lt;- ggplot(.SD, aes(interval, interMean))
  t &lt;- t + geom_line()
  t &lt;- t + geom_smooth()
  t &lt;- t + xlab(&quot;Interval&quot;) + ylab(&quot;Avg. Activity Level (Steps)&quot;) + 
          ggtitle(&quot;Daily Activity Pattern (Average)&quot;)
}]
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-8"/> </p>

<p>The time-series reaffirm noisy data. </p>

<pre><code class="r">DTint[, Smoothed := {
  myLoess &lt;- loess(data=.SD, interMean ~ interval)
  Smoothed &lt;- myLoess$fitted
}]
DTint[, interval[c(which.max(Smoothed), which.max(interMean))]]
</code></pre>

<p>The maximum number of steps across all days is found in interval <code>835</code> in raw data. Given the data are noisy, smoothing may produce a more robust estimate. Applying loess method, the maxima is found in interval <code>900</code>.</p>

<h2>Imputing missing values</h2>

<p>There are a number of records with missing values. </p>

<pre><code class="r">DTact[, sum(is.na(steps))]
</code></pre>

<pre><code>## [1] 2304
</code></pre>

<p>There are <code>2304</code> records missing steps. Replace these with the median value in that interval. For this purpose, I have written a function <code>impute</code>. Then tweaked it for vectorization with <code>Vectorize</code>.</p>

<pre><code class="r">impute &lt;- function(x, y) {
  if (is.na(x)) {
    x &lt;- y
  }
  x
}
vImpute &lt;- Vectorize(impute)
</code></pre>

<p>The function replaces <code>NA</code> values with the median value in that interval.</p>

<pre><code class="r">DTact[, interMedian := median(steps, na.rm=TRUE), by=interval]
DTact[, steps := vImpute(steps, interMedian)]
DTact[, interMedian := NULL]
</code></pre>

<p>Recompte totals with imputed values. Redo the histogram.</p>

<pre><code class="r">DTact[, Total := sum(steps), by=date]
</code></pre>

<pre><code>##        steps       date interval Total
##     1:     0 2012-10-01        0  1141
##     2:     0 2012-10-01        5  1141
##     3:     0 2012-10-01       10  1141
##     4:     0 2012-10-01       15  1141
##     5:     0 2012-10-01       20  1141
##    ---                                
## 17564:     0 2012-11-30     2335  1141
## 17565:     0 2012-11-30     2340  1141
## 17566:     0 2012-11-30     2345  1141
## 17567:     0 2012-11-30     2350  1141
## 17568:     0 2012-11-30     2355  1141
</code></pre>

<pre><code class="r">DTact[, {
  m &lt;- ggplot(.SD, aes(x=Total))
  m &lt;- m + geom_histogram(aes(y=..density..), binwidth=3000, 
                          color=&quot;black&quot;, fill=&quot;wheat&quot;, alpha=0.2) 
  m &lt;- m + geom_density(fill=&quot;gray&quot;, alpha=0.2)
  m &lt;- m + geom_vline(aes(xintercept=mean(Total, na.rm=TRUE)),
                      color=&quot;red&quot;, linetype=&quot;dashed&quot;, size=1)
  m &lt;- m + geom_vline(aes(xintercept=median(Total, na.rm=TRUE)),
                      color=&quot;blue&quot;, linetype=&quot;dashed&quot;, size=1)
  m &lt;- m + xlab(&quot;Daily Activity (Steps)&quot;) + ylab(&quot;Density&quot;) + 
          ggtitle(&quot;Variation in Daily Activity Levels&quot;)

}]
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-13"/> </p>

<pre><code class="r">DTact[, summary(Total)]
</code></pre>

<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##      41    6778   10400    9504   12810   21190
</code></pre>

<p>Imputation of values yields a mean of <code>9504</code> and median of <code>10400</code> steps per day. These adjusted values are lower than before.</p>

<h2>Are there differences in activity patterns between weekdays and weekends?</h2>

<p>The function <code>wDay</code> determines whether a specified date is a weekday or a weekend. It&#39;s vectorized version is <code>vwDay</code>.</p>

<pre><code class="r">wDay &lt;- function(date) {
  day &lt;- weekdays(date)
  if (day %in% c(&quot;Saturday&quot;, &quot;Sunday&quot;) ) {
    return(&quot;weekend&quot;)
  } else {
    return(&quot;weekday&quot;)
  }
}
wDay(as.Date(&quot;2015-10-18&quot;))
</code></pre>

<pre><code>## [1] &quot;weekend&quot;
</code></pre>

<pre><code class="r">vwDay &lt;- Vectorize(wDay)
</code></pre>

<p>Compute a new factor variable to indicate weekend. The time-series plot shows the activity on weekdays and weekends. </p>

<pre><code class="r">DTact[, day := factor(vwDay(date))]
</code></pre>

<pre><code>##        steps       date interval Total     day
##     1:     0 2012-10-01        0  1141 weekday
##     2:     0 2012-10-01        5  1141 weekday
##     3:     0 2012-10-01       10  1141 weekday
##     4:     0 2012-10-01       15  1141 weekday
##     5:     0 2012-10-01       20  1141 weekday
##    ---                                        
## 17564:     0 2012-11-30     2335  1141 weekday
## 17565:     0 2012-11-30     2340  1141 weekday
## 17566:     0 2012-11-30     2345  1141 weekday
## 17567:     0 2012-11-30     2350  1141 weekday
## 17568:     0 2012-11-30     2355  1141 weekday
</code></pre>

<pre><code class="r">DTwee &lt;- DTact[, .(interMean = mean(steps, na.rm=TRUE)), 
      by=c(&quot;interval&quot;, &quot;day&quot;)]
DTwee[, {
  t &lt;- ggplot(.SD, aes(interval, interMean))
  t &lt;- t + geom_line()
  t &lt;- t + geom_smooth()
  t &lt;- t + facet_grid(day ~ .)
  t &lt;- t + ylab(&quot;Activity Level (Steps)&quot;) + 
          ggtitle(&quot;Activity Levels: Weekday v Weekend&quot;)
}]
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-15"/> </p>

<p>The plot shows difference in daily activity between weekday and weekend. We can fit a regression model to examine the assocation between day of the week and activity level. A regression model can show statistically significant differences from day to day.</p>

<pre><code class="r">wDay &lt;- DTact[, {
  lm(Total ~ day)         
}]
summary(wDay)
</code></pre>

<pre><code>## 
## Call:
## lm(formula = Total ~ day)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -9857.4 -2194.5   927.5  3479.6 12221.5 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  8972.49      44.19  203.07   &lt;2e-16 ***
## dayweekend   2025.89      86.27   23.48   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 5030 on 17566 degrees of freedom
## Multiple R-squared:  0.03043,    Adjusted R-squared:  0.03038 
## F-statistic: 551.4 on 1 and 17566 DF,  p-value: &lt; 2.2e-16
</code></pre>

<p>This  model shows that daily activity on a weekend is higher than the activity on a weekday and the difference is statistically significant at 95% confidence. The boxplot illustrates this result. </p>

<pre><code class="r">DTact[, lapply(.SD, class)]
</code></pre>

<pre><code>##      steps date interval   Total    day
## 1: integer Date  integer integer factor
</code></pre>

<pre><code class="r">DTact[, {
  p &lt;- ggplot(.SD, aes(x=day, y=Total, fill=factor(day)))
  p &lt;- p + geom_boxplot() + geom_smooth(method=&quot;lm&quot;)
  p &lt;- p + ylab(&quot;Activity Level (Steps)&quot;) + 
          ggtitle(&quot;Activity Level: Weekday v Weekend&quot;)
}] 
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAbAAAAGwCAMAAAD/kMAYAAABPlBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZrYAv8Qfa20zMzMzZv86AAA6ADo6AGY6Ojo6OpA6ZpA6ZrY6kNtmAABmADpmAGZmOgBmOpBmZjpmZmZmZpBmZrZmkJBmtrZmtv9/f39/f5V/f6t/lcF/q9aCTkqQOgCQOjqQOmaQZmaQkGaQtpCQ27aQ29uQ2/+R3uCVf3+VlZWVlcGVq8GVq9aVweuZ5eerf5Wrf6urlZWrlcGrq5Wrq6urq8GrwcGr1v+2ZgC2Zjq2Zma2tma225C2/7a2/9u2///BlX/BlZXBlavBq6vBwdbB1sHB6//Wq3/Wq5XW/9bW///bkDrbkGbb29vb/7bb/9vb///l5eXrwZXrwavr/+vr///y8vL0wL34dm38yMX/tmb/1qv/25D/68H//7b//9b//9v//+v///+BEgDOAAAACXBIWXMAAAsSAAALEgHS3X78AAARRklEQVR4nO2di3/bVgGFlUDCSpqWOi3doNjtunbQYTpogPGyC3SmZbQjgi0ztIDjuo7+/3+Ae69kx49YD+foKNc6369VJFs+ku/ne3X1sBVEwiuCqldAFEPCPEPCPEPCPEPCPEPCPEPCPEPCPEPCPEPCPEPCPEPCPEPCPEPCPEPCPEPCPEPCPIMj7J+ZD4iclCQsDJpnE+MHjWh0s51MmTH7QDT/fApnL426u2YwCOzs4c7x4nwHZ8scbPfSVzB30iKZySVTjrDRwbWZUlgSsrYwV7bdD3bPfU0hYbmTFtlMYYPtP1+1pTzcC3aOxw+CYNeUuvtQd83YT+0Dbiq0g7Mis3OagkxmnExaYd14juF+Lxo//ORWzz2YPD+dzxTzcG/X/A22fmKK1Sw8MBV9ZkGT4LxJ0xV4tBdstaNpcpWUI6zbcBLMG7d/kybRfjbNI0mTaKfGD9wneSLM/TUf/WTGyeRMDbMvGF7/2g73e5Pnp/MdNId7zXhpB9s9V026272ZBSXBRZLiSfO6bvy0G6+SUoQNTfUKzRtLmo9EmC0q80gizH2K96fPW9zspiSTGaeTZ8JsTRs0orBhq8zk+bOX/eigkaRMGq5BLC5ZUBJcKClZn+kKbWSTGCbNSrI5n3Q6TGNk/k06HWY0bqimwsLA0UhmnEzOChuYZ2zVODbDyfPT+Q5cu+UW6gyZBwJbN6YLSoJzJ00nY2FnyRVShjBbUIFt/ReEDbafmbc+ETbc/zxuqM6ETToq8YyTyVlhw/1ndrNz6/OH7enz0/kOmgMzOilWsxZxw3u2oCS4UFKU9EE2WVjcagy22vNNonnjd/Z7U2HjB3eS9z7XJFriGSeTs8LGDx9dt927O2Y40+wlr2pONo6uAbPFG2/AJgtKggslRWfCNrZJ7E76fq5Z3D3bDwuD3Zn9MDeVzJn8NWU82JrMOJmcFRZ1r7mXXmucPT+dz26h7OSu6xq4yrU3TYuZGc2TdDZpRU2SSyiy/JQgbHg1LmDT7TA9a/v+Qtett738ZlxhXLm5KYvtPRvibvRWvDvQTB43kzPderuv21x8fjqf6xa63QjX+e6aLZhrAacLmhvNlzSdjOvqpnbrc0HbGlS92YFSobAw9fiGjwtiUJmw4d7SITzPF8ThYsK+QYFLqmrBIB+ZSBgqiISEoYJISBgqiISEoYJISBgqiISEoYJISBgqiISEoYJISBgqiISEoYJISBgqiISEoYJISBgqiISEoYJISBgqiMQlEXYFllQQCVsPCcuLhKGCSEgYKoiEhKGCSEgYKoiEhKGCSEgYKoiEhKGCSEgYKoiEhKGCSEgYKoiEhKGCSEgYKoiEhKGCSEgYKoiEhKGCSKwUdvqXVuvD19Gr1t2X0TnDGNS7lbDcrBR2ct+46Zx8+Prcf8lMqHcrYblJbRL7nf5h9O7XR8tD82TLAFuNK7CkTSdNmKlk/U50+uJoeZjMgfp4qoblJkXYK9MoptQwC+rdSlhuUjodHTPUNix3EImVwl7ZbdSheom5g0hoPwwVRELCUEEkJAwVRELCUEEkJAwVRELCUEEkJAwVRELCUEEkJAwVRELCUEEkJAwVRELCUEEkJAwVRELCUEEkJAwVRELCUEEkJAwVRELCUEEkJAwVRELCUEEkJAwVRELCUEEkJAwVRELCUEEkJAwVRELCUEEkJAwVRELCUEEkJAwVRELCUEEkJAwVRELCUEEkJAwVRELCUEEkLibsDYorsKSCwN4CyEcmqmGoIBIShgoiIWGoIBIShgoiIWGoIBIShgoiIWGoIBIShgoiIWGoIBIShgoiIWGoIBIShgoiIWGoIBIShgoiIWGoIBIShgoiIWGoIBIShgoiIWGoIBIShgoiIWGoIBIShgoiIWGoIBIShgoiIWGoIBIShgoiIWGoIBIShgoiIWGoIBIShgoiIWGoIBJ1FwZbMMhHJhIGAuQjEwkDAfKRiYSBAPnIJEWYu7/2q5a9C/Dm3hZ4g4SdtO4dRafPrZwNvvH25gg7/eL0xVH07rPHrfvn3ODezGBvzA1bjSuwJF8WvC4pTaIVdmJqWb/T79iJ2WEyC+rjqRqWmwxhlpPDc2uYBfVuJSw3WTXsMDI1TNuwbBiyLFk1zPQSDyP1ErMhuHJoPwwEyEcmEgYC5CMTCQMB8pGJhIEA+chEwkCAfGSygcKulMjqpYJ8ZLKJwr5TGhI2LWRYUs2EDQJLM++rcYUMS6qVsEGwa/+MH+RVhitkWFKdhI1uH09G/9jL9WpcIcOS6iSsOLhChiXVTFi4cxxqG+aPsNHNtvk33M/XIErYDHg157Mg7FbP1DEJ80ZYFAZb7YGaRH+EFQRXyLAkCUsDV8iwpJoJM/vMQbz3nAtcIcOS6iVs/KBhhmFuY7hChiXVS5jpJU6HecAVMiypXsLiyqUa5o2w0UEQs61jiV4IKwqukGFJEpYGrpBhSTUTZrr1O1/dbOd9Na6QYUn1Ema69cPrx4Od4xVzL4IrZFhSvYSZDr0Rpm69N8LiGhaqhvkiLD40ldtXmrBqrg6snbCCpBXbf0tDwqYAD01JWDnMXTU1Oc6B2IZJWDmcV8PyI2EVCyvKm9WUKSxlsXbJJQpbvVSQj0zmhI0OdqPhXt4jv5FqWNU1rNsw/fom5vSKhJXDXKfDbMHsJW7qJXokzB7lgFyXKGHlMN8kNt1FHV01iZ4IMztiO8e255EXCatWWGEkrFJhox9ORy/+/bB6CzNtVWN2+unsOeFuw80xe0F8/o55ad/ArLew4dW5s/aDrZnJkTujPy8sfz+vtO8411qY+chvfXLgDsqGQbBrJ9tde0m1Kd/tP233zAPf2mvaY7c7X5tuXnd3Xl8BYQWRsPOFJTXMVCzzz8iwI9u90UHDfjPIfmlyuzfca8ZzhDtfHcS989oKq+TU6bIwU6WsjuOJl2NTk2zb2N2x5/RtnXJzjG4+2jdVLu9GTMLKEma8xDXM1J6zGmaETWtYPEfUvbYb1buGXY4m0WyuzHbKbsN2jod7k22YETSYbMOSOWwzqW1YxcLSGC1c92kErtlLLHplvYStJSzeD5sS2j22NffDCiNh6wi7EBJWirD/LXGhcp6htGvray7sP4sgZFlKu7ZewhwflSsMeG29hDGEAa+tr72wj2YpSxjy2vraC5tZ4/KEFUTCJKxWwsLkgNTT3P3ypV8RyN8cStglEBbZC38xP11Ud2HfncMIG3/csz9Hefu4G9iDUW4YNsNdM7b9vjsZY0ab0fBGMWGWgY4lXlzYcg0Lm4NrzUFjsOtG3TC8cyMyY/ZHRW9E44d2GGYctlcNowkb3vjHoxtP26E9vN6YDHedIdMkhvZk5vjjZ1n7wNqG0YSNH37v6x//4HjgjtXHw7D5tG1qmKlbYcMOo/CDrBOZ6iWWJmxpx9lur+KtV9CMh2FzeN1s07autU3LtvV+c+lcWaYwHfyFCVvr0JTxV0iYDv5WKyzcyqwrm3jw9xJchMM9veL5wd9CwLLmC+aXS2B0beTB30KUJexniyBkWVJ6ie6G6Mt3cM55H+dqGqbClC3sPYaweBt20rp3FC3fIz3vndIljCzs9At7p/T+oa1oy0MzV8uQElxmk4h683Y1gVkzVFHDIiesY/8sD5M50z66JQpD1Ypvyqxh783CE7a6hknYHMvCZvbfeMIusA2TsGxh5x2azzg3lnKptmv51u8lSljpwoqTVhI1FzZ/AtMISzmBacaG1/bs/m98MlPCUlYTFbQobLmGrT6BGbmj9uOH7fhkpoSlrSYqKFvYqhOYbsxeGWCea6pJzIAobNUJTDcWC4tPZkpY2mqigpaFLe2HrTyBacZiYZE7mVlAWJGfLZKwOZaEkY50DOy1ILlfnVYSEsY6NGVPsfj8SziF8F6YvRiknfsnLtNKotbCymMDL3MrhO/CNuFGA4XwWtiG3GigEF4L25AbDRTCc2FFSSsJP4SlvYViQSTmf1X72cEG/BJOsXKGBZFQDUMFkZAwVBCJuu+HeS5sI77QV6ycYUEkNvArs8XKGRZEQjUMFURC2zBUEAn1ElFBJLTjjAoioRqGCiJR99MrXgur4+kVr4XV8fSK58KKkvIGJKwclm5H1czzYxETUt6AhJXDQpPorsT3/C6zxcoZFkRi8Xc63E2t1OlYI4jEQpPoOoqe39q+WDnDgkhcrNPxZjVlCktZbFHS3kKxIBLqJaKCSJwjLNSxxHWCSNT92yt+C3PfhOjmvimwhM0GkZg/vWKbQglbL4jEXA2znfqmhK0XRGKp09HVNmy9IBLnfgNTvcQ1gkhoPwwVRELCUEEkJAwVRELCUEEkJAwVRELCUEEkJAwVRELCUEEkJAwVRELCUEEkJAwVRELCUEEkJAwVRELCUEEkJAwVRELCUEEkJAwVRELCUEEkJAwVRELCUEEkJAwVRELCUEEkJAwVRELCUEEkJAwVRELCUEEkJAwVRELCUEEksoS9atm7AG/ubYE3Tdjpcytng2+8vWnC3n32uHX/nBvcm6dahpRXXikR4Pv3jgxhJ/eOon6n34lOXxzNDpOnUR9P3D1rirJpNcxycnhuDbOg3q2E5Sarhh1Gpoatsw0rhoTlJUcv8TBap5dYDAnLS2n7YcWQsLxIGCqIhIShgkhIGCqIhIShgkhIGCqIhIShgkhIGCqIhIShgkhIGCqIhIShgkhIGCqIhIShgkhIGCqIhIShgkhIGCqIhIShgkhIGCqIhIShgkhIGCqIhIShgkhIGCqIhIShgkhIGCqIhIShgkhIGCqIhIShgkhIGCqIhIShgkhIGCqIhIShgkhIGCqIhIShgkhIGCqIxMWEvUFxBZZUENhbAPnIRDUMFURCwlBBJCQMFURCwlBBJCQMFURCwlBBJCQMFURCwlBBJCQMFURCwlBBJCQMFURCwlBBJCQMFURCwlBBJCQMFURCwlBBJCQMFURCwlBBJGouLAhQSSAfmdRbWBDAjIF8ZCJhoCiQj0zqLUxN4rqo05EXCUMFkZAwVBAJCUMFkZAwVBAJCUMFkZAwVBAJCUMFkZAwVBAJCUMFkZAwVBAJCUMFkZAwVBCJ4sJ0W+Dzg0gUFqYbb68IIlFY2PTW9i1DCSsk0ikurBOdvjhKJlAfT9wHvbIFY7WsZv0aZkG9WwnLzSXZhklYXi5JL1HC8nJJ9sMkLC8ShgoiIWGoIBIShgoiIWGoIBIShgoiIWGoIBIShgoiIWGoIBIShgoiIWGoIBIXEwajsjNr3p3SkzDPkDDPkDDPuCTCRF4kzDMkzDMkzDMkzDMuh7B+J/775cv0+cpa7izsdSiIhC0iYQucvjh696uX737z+lWrdWivmjPDfqd/34zd++1LO21GO9HbJ7zlmrG3nz5uffg6WYfLTAU1rN85+bRzcnhy3426Yf8PTyIzZgrUeDp9bofnffjLWq4Ze/vz12a58TqgFwylAmFvn/zrb0++fNm336Y4nAzvO0OmOTIP3H15+uLv08vBS1+uG7MV2jzXUZO4zOnzX/z7r79/fXJoJ+Jhv/Ol/XSbz3j/0A6j/u8Oact1Y7GweB3gS0ZSRafDbjfirUirEw9dk/SqdffTl28ft+7+tlNOw7RyuWYsFha5dcAvGcjl6CUuYcqx6lW4pFxOYf27l/tjXiGXU5hYiYR5hoR5ht/Cxg+aVa8CGwnzDI+FjQ6Cb3+/GQ33gqAZdc3I9eOqV4mAx8K6jWgQNEc329FwvzcwE42q14iBv8JGt3qTJtGMjm4fP21XvUoM/BVmqlVkW8KoGwTbvfHDT27XoUX0WFhSw0YHTecu/KAWLaLHwpJtmJU1vNp2/+uAx8LGD1wvMQzcn/HHvapXiILHwuYZ3qh6DThsirBwqx4t4sYIqw0S5hkS5hkS5hkS5hkS5hkS5hkS5hn/B8GeDlRIc/gGAAAAAElFTkSuQmCC" alt="plot of chunk unnamed-chunk-17"/> </p>

<h2>Conclusion</h2>

<p>Data are noisy with over 10% records missing values. The imputation approach produces a preponderance of zero values. A more sophisticated approach may need to be considered. </p>

<p>Regression shows that weekend affects the daily activity level and that the difference is statistically significant. It may be worthwhile looking closer at this association. A regression model with all 7 days of the week as the explanatory variables should be illuminatiing. </p>

</body>

</html>
